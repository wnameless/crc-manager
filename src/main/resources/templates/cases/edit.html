<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="partial">
    <div class="row">
        <div class="col-sm-12 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
            <h3 th:replace="fragments/form :: title(text=${item.trialName}, backUrl=${item.indexPath})"></h3>

            <hr>

            <div class="panel-group">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            <a data-toggle="collapse" href="#fileList">
                                <i class="fas fa-file"></i>
                                [[#{ui.case.files.title}]]</a>
                        </h4>
                    </div>
                    <div id="fileList" class="panel-collapse collapse">
                        <div class="list-group">
                            <th:block th:each="file : ${files}">
                                <a th:unless="${file.value.value}" class="list-group-item list-group-item-action">
                                    [[${file.value.key}]]
                                    <label th:unless="${file.value.value}"
                                        class="pull-right">[[#{ui.case.files.unuploaded}]]</label>
                                </a>
                                <a th:if="${file.value.value}" th:href="${item.joinPath('files', file.key)}"
                                    class="list-group-item list-group-item-action">
                                    [[${file.value.key}]]
                                    <label th:if="${file.value.value}"
                                        class="pull-right">[[#{ui.case.files.download}]]</label>
                                </a>
                            </th:block>
                        </div>
                    </div>
                </div>
            </div>

            <hr>

            <div id="jsfForm"></div>
        </div>
    </div>

    <script type="text/javascript" th:inline="javascript">
        $(function () {
            let onSubmit = (f) => {
                axios.post( /*[[${item.updatePath}]]*/ null, f.formData).then((response) => {
                    $('#jsf').html(response.data);
                });
            };

            let rjsfOpt = Object.assign({
                btnText: /*[[#{rjsf.submit}]]*/ 'Submit',
                onSubmit: onSubmit
            }, /*[[${item.toRjsfMap()}]]*/ {});

            ReactDOM.render(React.createElement(ReactJSF, rjsfOpt),
                document.getElementById('jsfForm'));
        });
    </script>
</div>

</html>

<html th:fragment="complete" xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layouts/main.html}">

<section layout:fragment="content">
    <div class="container">
        <div id="jsf">
            <div th:replace="cases/edit :: partial"></div>
        </div>
    </div>
</section>

</html>