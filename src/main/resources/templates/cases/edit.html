<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="edit">
    <div class="row col-sm-12 col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2">
        <h3 th:replace="fragments/form :: title(text=${jsfItem.trialName}, backUrl='/cases')"></h3>

        <hr>

        <div class="panel-group">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a data-toggle="collapse" href="#fileList">
                            <i class="fas fa-file"></i>
                            [[#{ui.case.files.title}]]</a>
                    </h4>
                </div>
                <div id="fileList" class="panel-collapse collapse">
                    <div class="list-group">
                        <th:block th:each="file : ${files}">
                            <a th:unless="${file.value.value}" class="list-group-item list-group-item-action">
                                [[${file.value.key}]]
                                <label th:unless="${file.value.value}"
                                    class="pull-right">[[#{ui.case.files.unuploaded}]]</label>
                            </a>
                            <a th:if="${file.value.value}"
                                th:href="@{/cases/{id}/files/{fileId}(id=${jsfItem.id}, fileId=${file.key})}"
                                class="list-group-item list-group-item-action">
                                [[${file.value.key}]]
                                <label th:if="${file.value.value}"
                                    class="pull-right">[[#{ui.case.files.download}]]</label>
                            </a>
                        </th:block>
                    </div>
                </div>
            </div>
        </div>

        <hr>

        <div id="jsfForm"></div>
    </div>

    <script type="text/javascript" th:inline="javascript">
        $(function () {
            let onSubmit = (f) => {
                axios.post( /*[[${jsfPath}]]*/ null, f.formData).then(function (response) {
                    $('#jsf').html(response.data);
                });
            };

            let rjsfOpt = Object.assign({
                btnText: /*[[#{rjsf.submit}]]*/'送出',
                onSubmit: onSubmit
            }, /*[[${jsfItem.toRjsfMap()}]]*/ {});

            ReactDOM.render(React.createElement(ReactJSF, rjsfOpt),
                document.getElementById('jsfForm'));
        });
    </script>
</div>

</html>