<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="list">
	<table id="jsfTable" class="display">
		<thead>
			<tr>
				<th>案件狀態</th>
				<th>年度</th>
				<th>IRB/REC案件編號</th>
				<th class="text-center">CRC</th>
				<th class="text-center">受試者</th>
				<th>試驗中文名稱</th>
				<th>計畫主持人姓名</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="case : ${jsfItems}">
				<td>
					<div class="dropdown">
						<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true"
							th:text="${case.status}">
							<span class="caret"></span>
						</button>
						<ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
							<li><a th:href="@{'/cases/' + ${case.id} + '/status/new'}" data-value="new">新案</a></li>
							<li><a th:href="@{'/cases/' + ${case.id} + '/status/exec'}" data-value="exec">執行中</a></li>
							<li><a th:href="@{'/cases/' + ${case.id} + '/status/end'}" data-value="send">結案</a></li>
							<li class="divider"></li>
							<li><a th:href="@{'/cases/' + ${case.id} + '/status/none'}" data-value="none">無主計編號</a></li>
						</ul>
					</div>
				</td>
				<td th:text="${case.year}"></td>
				<td th:inline="text"><a th:onclick="${ 'showFormEvent(''' + jsfPath + '/' + case.id + ''')' }">
						<span><i class="fa fa-eye"></i></span>
					</a> <a th:onclick="${ 'editFormEvent(''' + jsfPath + '/' + case.id + '/edit' + ''')' }">
						<span><i class="fa fa-pencil"></i></span>
					</a>[[${case.caseNumber}]]</td>
				<td class="text-center"><a th:onclick="${ 'showFormEvent(''' + jsfPath + '/' + case.id + '/crc' + ''')' }">
						<span><i class="fa fa-eye"></i></span>
					</a> <a th:onclick="${ 'editFormEvent(''' + jsfPath + '/' + case.id + '/crc/edit' + ''')' }">
						<span><i class="fa fa-pencil"></i></span>
					</a></td>
					<td class="text-center"><span><i class="fa fa-user-plus"></i></span></td>
				<td th:text="${case.trialName}"></td>
				<td th:text="${case.piName}"></td>
			</tr>
		</tbody>
	</table>

	<script type="text/javascript" th:inline="javascript">
		var showFormEvent = function(path) {
			axios.get(path)
			.then(function (response) {
				$('#jsf').html(response.data);
			})
			.catch(function (error) {
				console.log(error);
			});
		};
		
		var editFormEvent = function(path) {
			axios.get(path)
			.then(function (response) {
				$('#jsf').html(response.data);
			})
			.catch(function (error) {
				console.log(error);
			});
		};
	
		$(document).ready(function() {
			$('#jsfTable').DataTable({
				"language" : {
					"url" : "/i18n/datatables-zh-TW.json"
				}
			});
		});
	</script>
</div>
</html>