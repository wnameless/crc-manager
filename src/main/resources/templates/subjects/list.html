<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="list">
    <table id="jsfTable" class="display">
        <thead>
            <tr>
                <th>狀態</th>
                <th>名字</th>
                <th>身分證字號</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="subject : ${jsfItems}">
                <td>
                    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="true" th:text="${subject.status}">
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                        <li><a th:href="@{${jsfPath} + '/' + ${subject.id} + '/status/prescreening'}" data-value="prescreening">預篩</a></li>
                        <li><a th:href="@{${jsfPath}+ '/' + ${subject.id} + '/status/screening'}" data-value="screening">篩查</a></li>
                        <li><a th:href="@{${jsfPath} + '/' + ${subject.id} + '/status/unqualified'}" data-value="unqualified">失格</a></li>
                        <li class="divider"></li>
                        <li><a th:href="@{${jsfPath} + '/' + ${subject.id} + '/status/ongoing'}" data-value="ongoing">執行</a></li>
                        <li class="divider"></li>
                        <li><a th:href="@{${jsfPath} + '/' + ${subject.id} + '/status/dropped'}" data-value="dropped">排除</a></li>
                        <li><a th:href="@{${jsfPath} + '/' + ${subject.id} + '/status/followup'}" data-value="followup">追蹤</a></li>
                        <li><a th:href="@{${jsfPath} + '/' + ${subject.id} + '/status/closed'}" data-value="closed">結案</a></li>
                    </ul>
                </td>
                <td th:text="${subject.name}"></td>
                <td th:text="${subject.nationalId}"></td>
                <td>
                    <a th:onclick="${ 'showFormEvent(''' + jsfPath + '/' + subject.id + ''')' }">
                        <span><i class="fa fa-search"></i></span>
                    </a>
                    |
                    <a th:onclick="${ 'editFormEvent(''' + jsfPath + '/' + subject.id + '/edit' + ''')' }">
                        <span><i class="fa fa-edit"></i></span>
                    </a>
                </td>
            </tr>
        </tbody>
    </table>

    <div class="row col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3">
        <button id="addSubject" class="btn btn-block btn-default" th:onclick="${ 'editFormEvent(''' + jsfPath + '/new' + ''')' }">
            <span><i class="fa fa-plus" style="color: green"></i></span> 新增受試者
        </button>
    </div>

    <script type="text/javascript" th:inline="javascript">
	var showFormEvent = function(path) {
      axios.get(path)
        .then(function (response) {
          console.log(response.data);
          $('#jsf').html(response.data);
        })
        .catch(function (error) {
          console.log(error);
        });
    };

    var editFormEvent = function(path) {
      axios.get(path)
        .then(function (response) {
          $('#jsf').html(response.data);
        })
        .catch(function (error) {
          console.log(error);
        });
    };

    $(function() {
      $('#jsfTable').DataTable({
        columnDefs: [ { "width": "36px", "targets": 0 } ],
        language: {
          url: '/i18n/datatables-zh-TW.json'
        }
      });
    });
	</script>
</div>
</html>